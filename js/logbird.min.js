var LOGBIRD=LOGBIRD||{};var onMainScreen=true;var section={cookies:document.getElementById("section-cookies"),dialogs:document.getElementById("section-dialog-wrapper"),navbar:document.getElementById("section-navbar"),progress:document.getElementById("section-progress"),header:document.getElementById("section-header"),messages:document.getElementById("section-messages"),files:document.getElementById("section-files"),submit:document.getElementById("section-submit"),blacklist:document.getElementById("section-blacklist"),settings:document.getElementById("section-settings"),debug:document.getElementById("section-debug"),poweredby:document.getElementById("section-poweredby"),output:document.getElementById("section-output"),footer:document.getElementById("section-footer")};var html={messageBox:document.getElementById("htmlMessageBox"),inputFiles:document.getElementById("htmlInputfiles"),logbirdTable:document.getElementById("htmlLogbirdTable"),fileName:document.getElementById("htmlFileName"),tagsNumber:document.getElementById("htmlTagsNumber"),tagList:document.getElementById("htmlTagList"),pidList:document.getElementById("htmlPidList"),fatalList:document.getElementById("htmlFatalList"),loadTime:document.getElementById("htmlLoadTime"),logbirdLogo:document.getElementById("htmlLogbirdLogo"),backToTop:document.getElementById("htmlBackToTop"),button:{browse:document.getElementById("htmlButtonBrowse"),submit:document.getElementById("htmlButtonSubmit")}};var output={messages:document.getElementById("output-messages"),filename:document.getElementById("output-filename"),metadata:document.getElementById("output-metadata"),priority:document.getElementById("output-priority"),list:{tag:document.getElementById("output-list-tag"),pid:document.getElementById("output-list-pid"),fatal:document.getElementById("output-list-fatal")}};var menu={home:document.getElementById("menu-home"),timeMeasure:document.getElementById("menu-time-measure"),timeValue:document.getElementById("menu-time-measure-value"),timeUpdate:document.getElementById("menu-time-measure-update"),timeSeconly:document.getElementById("menu-time-measure-seconly"),checkpoint:{menu:document.getElementById("menu-checkpoint-dropdown"),add:function(a){alert(a)}},checkpointMenu:document.getElementById("menu-checkpoint"),addCheckpoint:document.getElementById("menu-checkpoint-add"),checkpoint:document.getElementById("menu-checkpoint-difference"),update:function(a){$('[data-toggle="dropdown"]').parent().removeClass("open");if(format.haveTime(a)){if(logbird.settings.time.run){}else{}if(logbird.settings.time.secondsOnly){$(this.timeSeconly).attr("checked",true)}else{$(this.timeSeconly).attr("checked",false)}show(this.timeMeasure);hide(this.checkpointMenu)}else{hide(this.timeMeasure);hide(this.checkpointMenu)}}};function scrollWindowToLine(a){$("html,body").animate({scrollTop:($("#l"+a).offset().top-50)},0)}var dialog={self:document.getElementById("dialog"),init:function(){$(this.self).click(function(a){a.stopPropagation()})},input:{text:{title:document.getElementById("dialog-title"),close:document.getElementById("dialog-close"),text:document.getElementById("dialog-input-text"),submit:document.getElementById("dialog-submit"),show:function(c,a,b){$(this.title).html(c);$(section.dialogs).click(function(d){d.stopPropagation();b();dialog.input.text.toggle(true)});$(this.close).click(function(d){d.stopPropagation();b();dialog.input.text.toggle(true)});$(this.submit).click(function(f){f.stopPropagation();var d=a();if(d){dialog.input.text.toggle(true)}});this.text.value="";this.toggle(false)},value:function(){return this.text.value},toggle:function(a){$(section.dialogs).toggleClass("hide",a)}}}};function Checkpoint(c,a,b){this.time=c;this.name=a;this.obj=b;this.reset=function(){this.time=-1;this.obj="undefined"};this.update=function(){this.obj.find("td")[1].innerHTML='<span class="label min danger">'+this.name+"</span>"};this.remove=function(){this.obj.find("td")[1].innerHTML="";this.reset()}}var CheckpointManager={checkpointA:new Checkpoint(-1,"A","undefined"),checkpointB:new Checkpoint(-1,"B","undefined"),reset:function(){this.checkpointA.reset();this.checkpointB.reset();this.update()},setCheckpointA:function(b,a){if(this.checkpointA.time!=-1){this.checkpointA.remove()}this.checkpointA.time=b;this.checkpointA.obj=a;this.update()},setCheckpointB:function(b,a){if(this.checkpointB.time!=-1){this.checkpointB.remove()}this.checkpointB.time=b;this.checkpointB.obj=a;this.update()},update:function(){if(this.checkpointA.time!=-1){this.checkpointA.update()}if(this.checkpointB.time!=-1){this.checkpointB.update()}if(this.checkpointA.time!=-1&&this.checkpointB.time!=-1){var a=this.checkpointB.time-this.checkpointA.time;$(menu.checkpoint).html('<span class="label danger">A-B</span>: <span class="label">'+a.toFixed(6)+" s.</span>");$(menu.checkpoint).show()}else{$(menu.checkpoint).hide()}}};var blacklist={id:"htmlBlackList",list:new Array(),init:function(){var a=getCookie("CookieBlackList");if(a){this.list=JSON.parse(a);this.list.forEach(function(b){blacklist.push(b)})}},check:function(a){return this.list.indexOf(a)},add:function(a){if(this.check(a)==-1){this.list.push(a);this.push(a);this.update();return true}return false},remove:function(b){var a=this.check(b);if(a!=-1){this.list.splice(a,1);this.pop(b);this.update();return true}return false},update:function(){setCookie("CookieBlackList",JSON.stringify(this.list),999)},push:function(a){$("#"+blacklist.id).append('<span class="label success" data-tag="'+a+'" onclick="onBlacklistTagClick(this)">'+a+" </span>")},pop:function(a){$("#"+blacklist.id+' [data-tag="'+a+'"]').remove()},flush:function(){this.list=[];this.update();this.html("")},html:function(a){$("#"+this.id).html(a)}};function DebugTimer(a){this.time=0;this.description=a;this.start=function(){this.time=new Date().getTime()};this.stop=function(){var b=new Date().getTime()-this.time;console.log("[DEBUG] "+this.description+" : "+b+"ms.")};this.reset=function(){this.time=0}}function Process(a){this.pid=a;this.tid=[];this.count=1;this.visable=true;this.logs=[];this.tags=[];this.hide=function(){this.logs.toggleClass("hide",true);this.visable=false};this.show=function(){if(this.visable){return}selectivelyShow(this.logs,false,false,true);this.visable=true};this.check=function(b){return this.tid.indexOf(b)},this.sort=function(){this.tid.sort()},this.addTag=function(b){if(this.tags.hasOwnProperty(b)){this.tags[b]++}else{this.tags[b]=1}},this.removeTag=function(b){},this.addThread=function(b){if(this.check(b)==-1){this.tid.push(b);return true}return false},this.removeThread=function(c){var b=this.check(c);if(b!=-1){this.tid.splice(b,1);return true}return false},this.getTags=function(){var b="";for(var c in this.tags){if(this.tags.hasOwnProperty(c)){b+=c+" ("+this.tags[c]+") "}}return b.trim()}}function Priority(){this.logs=[];this.visable=true;this.show=function(){if(this.visable){return}selectivelyShow(this.logs,true,false,false);this.visable=true};this.hide=function(){this.logs.toggleClass("hide",true);this.visable=false};this.getSize=function(){return this.logs.length};this.reset=function(){this.visable=true;this.logs=[]}}function Tag(a){this.name=a;this.visable=true;this.logs=[];this.show=function(){if(this.visable){return}selectivelyShow(this.logs,false,true,false);this.visable=true};this.hide=function(){this.logs.toggleClass("hide",true);this.visable=false};this.getSize=function(){return this.logs.length};this.reset=function(){this.visable=true;this.logs=[]}}var format={RAW:0,BRIEF:1,PROCESS:2,TAG:3,TIME:4,THREADTIME:5,LONG:6,CRASH:7,KERNEL:8,SYSLOG:9,haveData:function(a){return(a==this.TIME||a==this.THREADTIME||a==this.LONG||a==this.SYSLOG)?true:false},haveTime:function(a){return(a==this.TIME||a==this.THREADTIME||a==this.LONG||a==this.CRASH||a==this.KERNEL||a==this.SYSLOG)?true:false},haveTag:function(a){return(a!=this.RAW&&a!=this.KERNEL)?true:false},havePriority:function(a){return(a!=this.RAW)?true:false},havePID:function(a){return(a!=this.RAW&&a!=this.TAG&&a!=this.KERNEL)?true:false},haveTID:function(a){return(a==this.THREADTIME||a==this.LONG||a==this.CRASH)?true:false},toString:function(a){switch(a){case this.BRIEF:return"Logcat::Brief";case this.PROCESS:return"Logcat::Process";case this.TAG:return"Logcat::Tag";case this.TIME:return"Logcat::Time";case this.THREADTIME:return"Logcat::Threadtime";case this.LONG:return"Logcat::Long";case this.CRASH:return"Crash";case this.KERNEL:return"Kernel";case this.SYSLOG:return"Syslog";default:return"Raw"}}};var logbird={priority:{verbose:new Priority(),debug:new Priority(),info:new Priority(),warning:new Priority(),error:new Priority(),fatal:new Priority()},tags:[],addTag:function(b){for(var c=0,a=this.tags.length;c<a;c++){if(b==this.tags[c].name){return}}this.tags.push(new Tag(b))},process:[],addProcess:function(d,a){for(var e=0,c=this.process.length;e<c;e++){if(d==this.process[e].pid){this.process[e].count++;this.process[e].addTag(a);return}}var b=new Process(d);b.addTag(a);this.process.push(b)},addThread:function(b,a){},isPriorityVisable:function(a){return this.priority[a].visable},isTagVisable:function(a){for(var d=0,b=this.tags.length;d<b;d++){var c=this.tags[d];if(a==c.name){return c.visable}}return false},isProcessVisable:function(b){for(var c=0,a=this.process.length;c<a;c++){var d=this.process[c];if(b==d.pid){return d.visable}}return false},format:format.RAW,unexpectedTimeDiff:0,listenersSetOnPriority:false,settings:{syntax:{colorized:true,keywords:["false","true","null","NULL","error","Error","ERROR"],colors:{keyword:"#ffffff",string:"#ff0000",number:"#ff0000"}},avoidEmptyLines:false,maxTagLength:18,time:{run:true,secondsOnly:true,limes:30.5}},scrollToTop:function(a){$("html, body").animate({scrollTop:0},a)},syntaxColor:function(d){var b=this.settings.syntax;if(b.colorized){for(var c=0,a=b.keywords.length;c<a;c++){d=d.replace(new RegExp("("+b.keywords[c]+")","g"),"<b>$1</b>")}}return d},reset:function(){this.priority.verbose.reset();this.priority.debug.reset();this.priority.info.reset();this.priority.warning.reset();this.priority.error.reset();this.priority.fatal.reset();this.tags=[];this.process=[];this.format=format.RAW;$("ul.dropdown-menu.dropdown-context.compressed-context").remove();html.logbirdTable.innerHTML="";html.fileName.innerHTML="";html.tagList.innerHTML="";html.tagsNumber.innerHTML="";html.fatalList.innerHTML="";html.inputFiles.innerHTML="";output.messages.innerHTML="";this.unexpectedTimeDiff=0;$(section.files).css("background-image","url(img/android.png)");statistics.reset();CheckpointManager.reset();fatalsArray=[];uploader.files=[];hide(html.loadTime);hide(section.navbar);hide(section.output);show(section.header);show(section.files);show(section.submit);show(section.blacklist);show(section.settings);show(section.feedback);show(section.about);show(section.contact);show(section.debug);show(section.poweredby);show(section.features);show(section.contact);onMainScreen=true;logbird.scrollToTop(300)},isBrowserSupportWorkers:function(){if(typeof(Worker)!=="undefined"){return true}else{return false}},workers:{upload:0},progress:{show:function(){show(section.progress)},hide:function(){hide(section.progress)}},output:{sendMessage:function(a,d,c){var b=new Array();b.push('<div class="alert alert-',a,' alert-dismissable">');b.push('<button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>');b.push("<strong>",d,"</strong> ");b.push(c);b.push("</div>");$(output.messages).append(b.join(""))},sendSuccess:function(b,a){this.sendMessage("success",b,a)},sendInfo:function(b,a){this.sendMessage("info",b,a)},sendWarning:function(b,a){this.sendMessage("warning",b,a)},sendError:function(b,a){this.sendMessage("danger",b,a)}}};var regex={DATA:"(\\d{2}-\\d{2})",TIME:"(\\d{2}:\\d{2}:\\d{2}.\\d{3})",TAG:"(.*?)",PRIO:"([VDIWEF]|VERBOSE|DEBUG|INFO|WARN|WARNING|ERROR|FATAL|NOTICE|\\d)",PID:"(\\s*\\d+\\s*)",TID:"(\\s*\\d+\\s*)",LOG:"(.*)",TIMSTP:"(\\d+\\.\\d+)"};var kPriority={KERN_EMERG:0,KERN_ALERT:1,KERN_CRIT:2,KERN_ERR:3,KERN_WARNING:4,KERN_NOTICE:5,KERN_INFO:6,KERN_DEBUG:7};var kRegexpInputFormatBrief=new RegExp("^"+regex.PRIO+"\\/"+regex.TAG+"\\("+regex.PID+"\\)\\s*:\\s"+regex.LOG+"$");var kRegexpInputFormatProcess=new RegExp("^"+regex.PRIO+"\\("+regex.PID+"\\)\\s"+regex.LOG+"\\s*\\("+regex.TAG+"\\)$");var kRegexpInputFormatTag=new RegExp("^"+regex.PRIO+"\\/"+regex.TAG+"\\s*:\\s"+regex.LOG+"$");var kRegexpInputFormatTime=new RegExp("^"+regex.DATA+"\\s"+regex.TIME+"\\s"+regex.PRIO+"\\/"+regex.TAG+"\\("+regex.PID+"\\)\\s*:\\s"+regex.LOG+"$");var kRegexpInputFormatThreadtime=new RegExp("^"+regex.DATA+"\\s"+regex.TIME+"\\s+"+regex.PID+"\\s+"+regex.TID+"\\s+"+regex.PRIO+"\\s+"+regex.TAG+"\\s*:\\s"+regex.LOG+"$");var kRegexpInputFormatLong=new RegExp("^\\[.*\\]$");var kRegexpTitle=new RegExp("^-{9}\\s|^Main log$|^Radio log$");var kRegexpInputFormatCrash=new RegExp("^\\s*"+regex.PRIO+"\\s+\\[\\s*"+regex.TIMSTP+"]\\s+\\("+regex.PID+":"+regex.TID+"\\)\\s+"+regex.TAG+"\\s{2}"+regex.LOG+"$");var kRegexpInputFormatKernel=new RegExp("^<"+regex.PRIO+">\\[\\s*"+regex.TIMSTP+"\\]\\s+"+regex.LOG+"$");var kRegexpInputFormatSyslog=new RegExp("^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)Z\\s*"+regex.PRIO+"\\s*([^:]+):\\s*(.*)$");var statistics={emptyLines:0,reset:function(){this.emptyLines=0}};var reader;var file;var fileName;var fileSize;var fileType;var fileLastModifiedDate;var fileMaxSize=5*1024*1024;var fileAllowedTypes=new Array("n/a","text/x-log","text/plain","application/octet-stream");var numberOfColumn=-1;var fatalsArray=new Array();function show(a){$(a).fadeIn(200)}function hide(a){$(a).fadeOut(200)}var befrTimerValue;var aftrTimerValue;var diffLoadTime;function startTimer(){befrTimerValue=new Date().getTime()}function stopTimer(){var a=new Date().getTime();diffLoadTime=(a-befrTimerValue);html.loadTime.innerHTML=(diffLoadTime+" msec");show(html.loadTime)}function selectivelyShow(b,k,c,j){for(var g=0,d=b.length;g<d;g++){var f=b[g];var h=true;var a=true;var e=true;if(format.havePriority(logbird.format)&&!k){h=logbird.isPriorityVisable($(f).data("priority"));if(!h){continue}}if(format.haveTag(logbird.format)&&!c){a=logbird.isTagVisable($(f).data("tag"));if(!a){continue}}if(format.havePID(logbird.format)&&!j){e=logbird.isProcessVisable($(f).data("pid"));if(!e){continue}}if(h&&a&&e){$(f).toggleClass("hide",false)}}}function onFileUpload(k){onMainScreen=false;var h=reader.result.replace(/\u0001/g,'<span class="label min danger">SOH</span>').replace(/\u0002/g,'<span class="label min danger">STX</span>').replace(/\u0003/g,'<span class="label min danger">ETX</span>').replace(/\u0004/g,'<span class="label min danger">EOT</span>').replace(/\u0005/g,'<span class="label min danger">ENQ</span>').replace(/\u0006/g,'<span class="label min danger">ACK</span>').replace(/\u0007/g,'<span class="label min danger">BEL</span>').replace(/\u0008/g,'<span class="label min danger">BS</span>').replace(/\u0009/g,'<span class="label min danger">TAB</span>').replace(/\u000b/g,'<span class="label min danger">VT</span>').replace(/\u000e/g,'<span class="label min danger">SO</span>').replace(/\u000f/g,'<span class="label min danger">SI</span>').replace(/\u0010/g,'<span class="label min danger">DLE</span>').replace(/\u0011/g,'<span class="label min danger">DC1</span>').replace(/\u0012/g,'<span class="label min danger">DC2</span>').replace(/\u0013/g,'<span class="label min danger">DC3</span>').replace(/\u0014/g,'<span class="label min danger">DC4</span>').replace(/\u0015/g,'<span class="label min danger">NAK</span>').replace(/\u0016/g,'<span class="label min danger">SYN</span>').replace(/\u0017/g,'<span class="label min danger">ETB</span>').replace(/\u0018/g,'<span class="label min danger">CAN</span>').replace(/\u0019/g,'<span class="label min danger">EM</span>').replace(/\u001a/g,'<span class="label min danger">SUB</span>').replace(/\u001b/g,'<span class="label min danger">ESC</span>').replace(/\u001c/g,'<span class="label min danger">FS</span>').replace(/\u001d/g,'<span class="label min danger">GS</span>').replace(/\u001e/g,'<span class="label min danger">RS</span>').replace(/\u001f/g,'<span class="label min danger">US</span>').replace(/\r\n|\n\r|\r/g,"\n").split("\n");logbird.format=discoveryLogInputFormat(h);console.log("Discovered input format : "+format.toString(logbird.format));var t=[];var x=new DebugTimer("Generate header for table");x.start();t.push("<thead>");t.push("<tr>");t.push('<th class="col-line">Line</th>');if(format.haveTime(logbird.format)){t.push('<th class="col-icon">I</th>')}if(format.haveData(logbird.format)){t.push('<th class="col-data">Data</th>')}if(format.haveTime(logbird.format)){t.push('<th class="col-time">Time</th>')}if(format.haveTag(logbird.format)){t.push('<th class="col-tag">Tag</th>')}if(format.havePriority(logbird.format)){t.push('<th class="col-priority">P</th>')}if(format.havePID(logbird.format)){t.push('<th class="col-pid">PID</th>')}if(format.haveTID(logbird.format)){t.push('<th class="col-pid">TID</th>')}t.push('<th class="col-msg">Message</th>');t.push("</tr>");t.push("</thead>");x.stop();x=new DebugTimer("Generate table content");x.start();t.push("<tbody>");var n=0;var d=0;var v=0;var m=0;for(var r=0,o=h.length;r<o;r++){var d=r-n;var c=numberOfColumn;if(h[r].trim()==""){continue}if(kRegexpTitle.test(h[r])){console.log(h[r]);continue}var e=parseLog(logbird.format,h[r]);if(logbird.settings.avoidEmptyLines&&e.msg.trim()==""){statistics.emptyLines++;return}if(e.type=="log"){t.push('<tr id="l',d,'" class="log');if(format.haveTag(logbird.format)){if(!(blacklist.check(e.tag)<0)){t.push(" hide")}}t.push('"');if(format.haveTag(logbird.format)){t.push(' data-tag="',e.tag,'"')}if(format.havePriority(logbird.format)){t.push(' data-priority="');if(logbird.format==format.KERNEL){t.push(kPriorityToString(e.priority))}else{t.push(priorityToString(e.priority))}t.push('"');if(e.priority=="F"){fatalsArray.push([d,e.msg])}}if(format.havePID(logbird.format)){t.push(' data-pid="',e.pid,'"')}if(format.haveTID(logbird.format)){t.push(' data-tid="',e.tid,'"')}if(format.haveTime(logbird.format)){t.push(' data-time="');if(logbird.format==format.CRASH||logbird.format==format.KERNEL){t.push(e.time)}else{t.push(logTime2Timestamp(e.time))}t.push('"')}t.push(">");t.push('<td link-to-line="',d,'">',d,"</td>");if(format.haveTime(logbird.format)){t.push('<td><span class="label checkpoint">&nbsp;</span></td>')}if(format.haveData(logbird.format)){t.push('<td class="nw">',e.data,"</td>");c--}if(format.haveTime(logbird.format)){t.push("<td>",e.time,"</td>");c--}if(format.haveTag(logbird.format)){t.push("<td>",wrapTag(e.tag),"</td>");logbird.addTag(e.tag);c--}if(format.havePriority(logbird.format)){t.push("<td>",e.priority,"</td>");c--}if(format.havePID(logbird.format)){t.push("<td>",e.pid,"</td>");if(format.haveTag(logbird.format)){logbird.addProcess(e.pid,e.tag)}else{logbird.addProcess(e.pid,"")}c--}if(format.haveTID(logbird.format)){t.push("<td>",e.tid,"</td>");logbird.addThread(e.tid,e.pid);c--}if(c>1){t.push('<td colspan="',c,'">',e.msg,"</td>")}else{t.push("<td>",logbird.syntaxColor(e.msg),"</td>")}t.push("</tr>")}else{if(e.type=="waif"){t[t.length-3]+='<span class="label min danger">NL</span>'+e.msg;n++}}}t.push("</tbody>");html.logbirdTable.innerHTML=t.join("");x.stop();html.fileName.innerHTML='<h1 class="section-title">'+fileName+' </h1><span class="label success">'+format.toString(logbird.format)+'</span><span class="label success">'+h.length+' logs</span><span class="label success">'+fileType+'</span><span class="label success">'+fileSize+" bytes</span>";x=new DebugTimer("Generate priority list");x.start();if(format.havePriority(logbird.format)){var b=logbird.priority;var s=$(html.logbirdTable);b.verbose.logs=s.find('tr[data-priority="verbose"]');b.debug.logs=s.find('tr[data-priority="debug"]');b.info.logs=s.find('tr[data-priority="info"]');b.warning.logs=s.find('tr[data-priority="warning"]');b.error.logs=s.find('tr[data-priority="error"]');b.fatal.logs=s.find('tr[data-priority="fatal"]');$("#label-verbose").data("original-title",b.verbose.getSize());$("#label-debug").data("original-title",b.debug.getSize());$("#label-info").data("original-title",b.info.getSize());$("#label-warning").data("original-title",b.warning.getSize());$("#label-error").data("original-title",b.error.getSize());$("#label-fatal").data("original-title",b.fatal.getSize());if(!logbird.listenersSetOnPriority){logbird.listenersSetOnPriority=true;$("#label-verbose").click(function(){b.verbose.visable=onClickPriority("verbose",b.verbose.visable)});$("#label-debug").click(function(){b.debug.visable=onClickPriority("debug",b.debug.visable)});$("#label-info").click(function(){b.info.visable=onClickPriority("info",b.info.visable)});$("#label-warning").click(function(){b.warning.visable=onClickPriority("warning",b.warning.visable)});$("#label-error").click(function(){b.error.visable=onClickPriority("error",b.error.visable)});$("#label-fatal").click(function(){b.fatal.visable=onClickPriority("fatal",b.fatal.visable)})}show(output.priority)}else{hide(output.priority)}x.stop();x=new DebugTimer("Generate Tag list");x.start();if(format.haveTag(logbird.format)){var f=logbird.tags.length;var a=[];var s=$(html.logbirdTable);for(var r=0;r<f;r++){var w=logbird.tags[r];w.logs=s.find('tr[data-tag="'+w.name+'"]');a.push('<span class="label tag ');if(blacklist.check(w.name)<0){a.push("success")}else{a.push("default")}a.push('" data-tag="',w.name,'">',w.name,' <span class="badge">',w.getSize(),"</span> ","</span>")}html.tagsNumber.innerHTML=f;html.tagList.innerHTML=a.join("");$("#htmlTagList [data-tag]").click(function(){var i=$(this);if(i.hasClass("success")){hideTag(i.data("tag"))}else{showTag(i.data("tag"))}processTimeDiff()});show(output.list.tag)}else{hide(output.list.tag)}x.stop();if(format.havePID(logbird.format)){x=new DebugTimer("Generate Process and/or Threads list");x.start();logbird.process.sort(function(j,i){return j.pid-i.pid});var u=new Array();u.push('<h3>Processes <span class="badge">',logbird.process.length,"</span>",' <a class="btn btn-default" onClick="showAllProcess()" >All</a>',' <a class="btn btn-default" onClick="hideAllProcess()">None</a>',' <button type="button" disabled="true" class="btn btn-default"><span class="glyphicon glyphicon-sort-by-attributes-alt"></span></button>',' <button type="button" disabled="true" class="btn btn-default"><span class="glyphicon glyphicon-sort-by-attributes"></span></button>',' <button type="button" disabled="true" class="btn btn-default"><span class="glyphicon glyphicon-sort-by-order"></span></button>',' <button type="button" disabled="true" class="btn btn-default"><span class="glyphicon glyphicon-sort-by-order-alt"></span></button></h3>');for(var r=0,o=logbird.process.length;r<o;r++){var g=logbird.process[r];u.push('<span class="label pid success" data-pid="',g.pid,'" data-toggle="tooltip" data-placement="top" title="',g.getTags(),'">',g.pid,' <span class="badge">',g.count,"</span> ","</span> ")}html.pidList.innerHTML=u.join("");$('[data-toggle="tooltip"]').tooltip();$("#htmlPidList [data-pid]").click(function(){var i=$(this);if(i.hasClass("success")){hideProcess(i.data("pid"))}else{showProcess(i.data("pid"))}processTimeDiff()});for(var r=0,o=logbird.process.length;r<o;r++){logbird.process[r].logs=$("#htmlLogbirdTable tr[data-pid="+logbird.process[r].pid+"]")}show(output.list.pid);x.stop()}else{hide(output.list.pid)}x=new DebugTimer("Generate Fatals List");x.start();if(fatalsArray.length>0){var a=new Array();a.push('<h3>Fatals <span class="badge">',fatalsArray.length,"</span></h3>");for(var r=0,q=fatalsArray.length;r<q;r++){a.push('<div class="fatal-record"><span class="label danger" data-anchor="',fatalsArray[r][0],'">',fatalsArray[r][0],"</span>",'<span class="label default">',fatalsArray[r][1],"</span></div>")}html.fatalList.innerHTML=a.join("");show(output.list.fatal);$("[data-anchor]").click(function(i){scrollWindowToLine($(this).data("anchor"))})}else{hide(output.list.fatal)}x.stop();x=new DebugTimer("UI update");x.start();menu.update(logbird.format);hide(section.header);hide(section.files);hide(section.submit);hide(section.blacklist);hide(section.settings);hide(section.feedback);hide(section.about);hide(section.contact);hide(section.debug);hide(section.poweredby);hide(section.features);hide(section.contact);show(section.navbar);show(section.output);show(html.logbirdTable);x.stop();processTimeDiff();updateTooltips();stopTimer();if(logbird.unexpectedTimeDiff>3){logbird.output.sendWarning("Warning!","Your logs look to be damaged due to the large number of logs possessing earlier date than that preceded.")}logbird.scrollToTop(800)}function zeroPad(b,a){var c=a-b.toString().length+1;return Array(+(c>0&&c)).join("0")+b}function processTimeDiff(){if(!logbird.settings.time.run||!format.haveTime(logbird.format)){return}var a=new DebugTimer("processTimeDiff()");a.start();var b=true;var c=-1;jQuery(".note-time").remove();$("#htmlLogbirdTable > tbody  > tr.log").each(function(){var e=$(this);var h=e.data("time");var d=e.css("display")!="none";if(!d){return}if(b){b=false;c=h;return}var g=h-c;c=h;if(false){console.log("Difference beatween "+h+" and "+c+" is "+g+".")}var f=[];if(g<0){logbird.unexpectedTimeDiff++;f.push('<tr class="note-time error"><td colspan="',numberOfColumn,'">','<span class="glyphicon glyphicon-time"></span> ');if(logbird.settings.time.secondsOnly){f.push(g.toFixed(6));f.push(" seconds ")}else{f.push(makeFullTimeFromMs(g))}f.push("</td></tr>");e.before(f.join(""))}else{if(g>logbird.settings.time.limes){f.push('<tr class="note-time">');f.push('<td colspan="',numberOfColumn,'"><span class="glyphicon glyphicon-time"></span> ');if(logbird.settings.time.secondsOnly){f.push(g.toFixed(6));f.push(" seconds ")}else{f.push(makeFullTimeFromMs(g))}f.push("</td></tr>");e.before(f.join(""))}}});a.stop()}function makeFullTimeFromMs(c){var b=(c<0);var f=c;if(b){f=-c}var e=Math.floor(f/3600);var d=Math.floor(f/60)%60;var g=Math.floor(f)-(e*3600)-(d*60);var h=(f%1).toFixed(3)*1000;var a=zeroPad(e,2)+":"+zeroPad(d,2)+":"+zeroPad(g,2)+"."+zeroPad(h,3);if(b){a="-"+a}return a}function logTime2Timestamp(f){var i=-1;if(format.haveTime(logbird.format)){var a=f.trim();var g=new RegExp("^(\\d{2}):(\\d{2}):(\\d{2})\\.(\\d+)$");if(g.test(a)){var c=g.exec(a);var h=parseInt(c[1]);var b=parseInt(c[2]);var d=parseInt(c[3]);var e=parseInt(c[4]);console.log(logbird.format);if(logbird.format==format.SYSLOG){i=(e/1000000)+d+(b*60)+(h*3600)}else{i=(e/1000)+d+(b*60)+(h*3600)}}}return i}function updateTooltips(){$("[rel=tooltip]").tooltip()}function discoveryLogInputFormat(a){var b=2;for(var c=0;c<10;c++){var d=a[c];if(kRegexpInputFormatBrief.test(d)){numberOfColumn=4+b;return format.BRIEF}if(kRegexpInputFormatProcess.test(d)){numberOfColumn=3+b;return format.PROCESS}if(kRegexpInputFormatTag.test(d)){numberOfColumn=3+b;return format.TAG}if(kRegexpInputFormatTime.test(d)){numberOfColumn=6+b;return format.TIME}if(kRegexpInputFormatThreadtime.test(d)){numberOfColumn=7+b;return format.THREADTIME}if(kRegexpInputFormatLong.test(d)){numberOfColumn=7+b;return format.LONG}if(kRegexpInputFormatKernel.test(d)){numberOfColumn=3+b;return format.KERNEL}if(kRegexpInputFormatCrash.test(d)){numberOfColumn=7+b;return format.CRASH}if(kRegexpInputFormatSyslog.test(d)){numberOfColumn=6+b;return format.SYSLOG}}numberOfColumn=1+b;return format.RAW}function validateTag(a){var b=a.trim();return(b=="")?".unknown":b}function wrapTag(a){var c=logbird.settings.maxTagLength;if(a.length<(c+2)){return a}var b=a.substring(0,(c/2));b+="...";b+=a.substring(a.length-(c/2),a.length);return b}function priorityToString(a){if(!a){return"verbose"}p=a.toLowerCase();if(p=="v"||p=="verbose"){return"verbose"}if(p=="d"||p=="debug"||p=="notice"){return"debug"}if(p=="i"||p=="info"){return"info"}if(p=="w"||p=="warn"||p=="warning"){return"warning"}if(p=="e"||p=="err"|p=="error"){return"error"}if(p=="f"||p=="fatal"){return"fatal"}return""}function kPriorityToString(a){if(a==0){return"fatal"}if(a==1||a==2||a==3){return"error"}if(a==4){return"warning"}if(a==5){return"info"}if(a==6){return"debug"}return"verbose"}function parseLog(a,b){switch(a){case format.BRIEF:return parseBriefLog(b);case format.PROCESS:return parseProcessLog(b);case format.TAG:return parseTagLog(b);case format.TIME:return parseTimeLog(b);case format.THREADTIME:return parseThreadtimeLog(b);case format.LONG:return parseLongLog(b);case format.CRASH:return parseCrashLog(b);case format.KERNEL:return parseKernelLog(b);case format.SYSLOG:return parseSyslogLog(b);case format.RAW:default:return parseRawLog(b)}}function parseBriefLog(e){var c=kRegexpInputFormatBrief.exec(e);if(c!=null&&c.length){var d=c[1];var a=validateTag(c[2]);var b=c[3].trim();var f=c[4];return{type:"log",priority:d,tag:a,pid:b,msg:f}}else{return{type:"waif",msg:e}}}function parseProcessLog(e){var c=kRegexpInputFormatProcess.exec(e);if(c!=null&&c.length){var d=c[1];var b=c[2].trim();var f=c[3];var a=validateTag(c[4]);return{type:"log",priority:d,tag:a,pid:b,msg:f}}else{return{type:"waif",msg:e}}}function parseTagLog(d){var b=kRegexpInputFormatTag.exec(d);if(b!=null&&b.length){var c=b[1];var a=validateTag(b[2]);var e=b[3];return{type:"log",priority:c,tag:a,msg:e}}else{return{type:"waif",msg:d}}}function parseRawLog(a){return{type:"log",msg:a}}function parseTimeLog(e){var c=kRegexpInputFormatTime.exec(e);if(c!=null&&c.length){var f=c[1];var g=c[2];var d=c[3];var a=validateTag(c[4]);var b=c[5].trim();var h=c[6];return{type:"log",data:f,time:g,priority:d,tag:a,pid:b,msg:h}}else{return{type:"waif",msg:e}}}function parseThreadtimeLog(d){var f=kRegexpInputFormatThreadtime.exec(d);if(f!=null&&f.length){var e=f[1];var b=f[2];var g=f[3].trim();var c=f[4].trim();var h=f[5];var i=validateTag(f[6]);var a=f[7];return{type:"log",data:e,time:b,pid:g,tid:c,priority:h,tag:i,msg:a}}else{return{type:"waif",msg:d}}}function parseLongLog(a){return{type:"log",msg:a}}function parseCrashLog(e){var c=kRegexpInputFormatCrash.exec(e);if(c!=null&&c.length){var d=c[1];var g=c[2];var b=c[3].trim();var f=c[4].trim();var a=validateTag(c[5]);var h=c[6];return{type:"log",priority:d,time:g,pid:b,tid:f,tag:a,msg:h}}else{return{type:"waif",msg:e}}}function parseKernelLog(c){var a=kRegexpInputFormatKernel.exec(c);if(a!=null&&a.length){var b=a[1];var d=a[2];var e=a[3];return{type:"log",priority:b,time:d,msg:e}}else{return{type:"waif",msg:c}}}function parseSyslogLog(e){var h=kRegexpInputFormatSyslog.exec(e);var a=new RegExp("^(.+)\\[(\\d+)\\]$");if(h!=null&&h.length){var f=h[1]+"-"+h[2]+"-"+h[3];var d=h[4]+":"+h[5]+":"+h[6]+"."+h[7];var k=h[8];var l=validateTag(h[9]);var c=h[10];var g="kernel";if(a.test(l)){var i=a.exec(l);if(i!=null&&i.length){l=i[1];g=i[2]}}else{c=c.replace(/(^\[ +\d+\.\d+\] )/mg,"");var j=new RegExp("^([0-9a-zA-Z\\-_:\\[\\]]+) +(.*)$");var b=j.exec(c);if(b!=null&&h.length){l=validateTag(b[1].replace(/[\[\]:]/mg,""));c=b[2]}}return{type:"log",priority:k[0],data:f,time:d,pid:g,tag:l,msg:c}}else{return{type:"waif",msg:e}}}function onClickPriority(b,a){if(a){hidePriority(b);$("#label-"+b).removeClass("success").addClass("default");processTimeDiff();return false}else{showPriority(b);$("#label-"+b).removeClass("default").addClass("success");processTimeDiff();return true}}function showPriority(b){var a=new DebugTimer("showPriority("+b+")");a.start();logbird.priority[b].show();a.stop()}function hidePriority(b){var a=new DebugTimer("hidePriority("+b+")");a.start();logbird.priority[b].hide();a.stop()}function showTag(d){var c=new DebugTimer("showTag("+d+")");c.start();for(var e=0,b=logbird.tags.length;e<b;e++){var a=logbird.tags[e];if(a.name==d){a.show();break}}$('.label.tag[data-tag="'+d+'"]').removeClass("default").addClass("success");c.stop()}function hideTag(d){var c=new DebugTimer("hideTag("+d+")");c.start();for(var e=0,b=logbird.tags.length;e<b;e++){var a=logbird.tags[e];if(a.name==d){a.hide();break}}$('.label.tag[data-tag="'+d+'"]').removeClass("success").addClass("default");c.stop()}function showAllTags(){var b=new DebugTimer("showAllTags()");b.start();for(var c=0,a=logbird.tags.length;c<a;c++){logbird.tags[c].show()}$("#htmlTagList .label.tag").removeClass("default").addClass("success");b.stop();processTimeDiff()}function hideAllTags(){var b=new DebugTimer("hideAllTags()");b.start();for(var c=0,a=logbird.tags.length;c<a;c++){logbird.tags[c].hide()}$("#htmlTagList .label.tag").removeClass("success").addClass("default");b.stop();processTimeDiff()}function displayOnlyTag(a){$("tr[data-tag!='"+a+"']").toggleClass("hide",true);$('.label.tag[data-tag!="'+a+'"]').removeClass("success").addClass("default")}function showProcess(c){var b=new DebugTimer("showProcess("+c+")");b.start();for(var d=0,a=logbird.process.length;d<a;d++){if(c==logbird.process[d].pid){logbird.process[d].show();break}}$('#htmlPidList [data-pid="'+c+'"]').removeClass("default").addClass("success");b.stop()}function hideProcess(c){var b=new DebugTimer("hideProcess("+c+")");b.start();for(var d=0,a=logbird.process.length;d<a;d++){if(c==logbird.process[d].pid){logbird.process[d].hide();break}}$('#htmlPidList [data-pid="'+c+'"]').removeClass("success").addClass("default");b.stop()}function showAllProcess(){var b=new DebugTimer("showAllProcess()");b.start();for(var c=0,a=logbird.process.length;c<a;c++){logbird.process[c].show()}$("#htmlPidList .label.pid").removeClass("default").addClass("success");b.stop();processTimeDiff()}function hideAllProcess(){var b=new DebugTimer("hideAllProcess()");b.start();for(var c=0,a=logbird.process.length;c<a;c++){logbird.process[c].hide()}$("#htmlPidList .label.pid").removeClass("success").addClass("default");b.stop();processTimeDiff()}var tagRegexInputChangePending=false;var timeValueInputChangePending=false;function onTagRegexInputChange(c){if(tagRegexInputChangePending){console.log("onTagRegexInputChange pending!");return}tagRegexInputChangePending=true;var b=$(html.tagList).find(".tag");if(c.value==""){show(b);tagRegexInputChangePending=false;return}var e=new RegExp(c.value,"i");for(var d=0,a=b.length;d<a;++d){if(e.test($(b[d]).data("tag"))){show(b[d])}else{hide(b[d])}}tagRegexInputChangePending=false}function onTimeValueChange(a){if(timeValueInputChangePending){console.log("onTimeValueChange pending!");return}timeValueInputChangePending=true;if(a.value==""){return}console.log(a.value);logbird.settings.time.limes=a.value;timeValueInputChangePending=false}function onTimeSecOnlyClick(a){logbird.settings.time.secondsOnly=$(menu.timeSeconly).is(":checked")}function abortRead(){reader.abort()}var uploader={isBrowserSupportFile:function(){return window.File},isBrowserSupportFileReader:function(){return window.FileReader},isBrowserSupportFileList:function(){return window.FileList},isBrowserSupportBlob:function(){return window.Blob},isBrowserSupportFileApi:function(){return this.isBrowserSupportFileReader()},onBrowse:function(){$("#file").click()},onSubmit:function(){if(!this.isBrowserSupportFileApi()){logbird.output.sendError("Error!","The File APIs are not fully supported in this browser.");return}startTimer();reader=new FileReader();reader.onerror=function a(b){switch(b.target.error.code){case b.target.error.NOT_FOUND_ERR:logbird.output.sendError("Error!",'File "'+fileName+'" not found!');break;case b.target.error.NOT_READABLE_ERR:logbird.output.sendError("Error!",'File "'+fileName+'" is not readable');break;case b.target.error.ABORT_ERR:logbird.output.sendError("Error!",'Cannot abort file "'+fileName+"!");break;default:logbird.output.sendError("Error!",'An error occurred reading "'+fileName+'".')}};reader.onabort=function(b){logbird.output.sendError("Error!","File read cancelled")};reader.onloadstart=function(b){logbird.progress.show()};reader.onload=function(b){setTimeout(logbird.progress.hide(),3000);onFileUpload(b)};reader.readAsText(file)},onFileChange:function(c){file=c[0];fileName=escape(file.name);fileSize=file.size;fileType=file.type?file.type:"n/a";fileLastModifiedDate=file.lastModifiedDate?file.lastModifiedDate.toLocaleDateString():"n/a";var d="";var a=true;var e="";if(fileName=="file"){return}if(fileAllowedTypes.indexOf(fileType)<0){a=false;d="NOT_SUPPORTED"}if(fileSize>fileMaxSize){a=false;d="MAX_SIZE"}if(a){console.log(file)}else{e="error";file=undefined}var b=new Array();b.push('<div class="file-record ',e,'">','<button class="file-record-close" aria-hidden="true">&times;</button>','<div class="file-record-name">',fileName,"</div>",'<div class="file-record-size">',fileSize," bytes</div>",'<div class="file-record-mime">',fileType,"</div>",'<div class="file-record-error">',d,"</div>","</div>");$("#htmlInputfiles").html(b.join(""));$(section.files).css("background-image","none");$("#htmlInputfiles .close").click(function(){var f=$(this).parent();f.remove();file=undefined;logbird.reset()})}};function prepareContext(){document.oncontextmenu=function(){return false};context.init({fadeSpeed:200,compress:true,preventDoubleContext:false});$("table").delegate("tr","mousedown",function(d){var e=[];if(d.button==2){if(format.haveTag(logbird.format)){var a=$(this).data("tag");e.push({header:'<b><span class="glyphicon glyphicon-tag"></span> '+a+"</b>"},{text:"Hide all",action:function(h){h.preventDefault();hideTag(a);processTimeDiff()}},{text:"Show only this",action:function(h){h.preventDefault();displayOnlyTag(a);processTimeDiff()}},{header:'<b><span class="glyphicon glyphicon-file"></span> Blacklist</b>'},{text:"Add to BlackList",action:function(h){h.preventDefault();blacklist.add(a);hideTag(a);processTimeDiff()}})}if(format.havePID(logbird.format)){var c=$(this).data("pid");e.push({header:'<b><span class="glyphicon glyphicon-align-justify"></span> PID '+c+"</b>"},{text:"Hide all",action:function(h){h.preventDefault();hideProcess(c);processTimeDiff()}})}if(format.haveTID(logbird.format)){var g=$(this).data("tid")}if(format.haveTime(logbird.format)){var b=$(this);var f=b.data("time");e.push({header:'<b><span class="glyphicon glyphicon-time"></span> Checkpoints</b>'},{text:"Set Checkpoint A",action:function(h){h.preventDefault();CheckpointManager.setCheckpointA(f,b)}},{text:"Set Checkpoint B",action:function(h){h.preventDefault();CheckpointManager.setCheckpointB(f,b)}})}if(e.length==0){return}context.attach($(this),e)}context.destroy($(this))})}function setListeners(){$(menu.home).click(function(){logbird.reset()});$(html.button.browse).click(function(){uploader.onBrowse()});$(html.button.submit).click(function(){uploader.onSubmit()});$("#file").change(function(){uploader.onFileChange($(this))});function a(b){uploader.onFileChange(b.target.files)}document.getElementById("file").addEventListener("change",a,false);$("#htmlTagRegex").bind("input",function(){onTagRegexInputChange(this)});$("#htmlTagRegexClear").click(function(){document.getElementsByName("htmlTagRegex")[0].value="";$("#htmlTagList .tag").show()});$(menu.timeValue).bind("input",function(){onTimeValueChange(this)});$(menu.timeSeconly).click(function(b){onTimeSecOnlyClick(b)});$(html.backToTop).click(function(){$("html, body").animate({scrollTop:0},"800");return false});$("#settings-avoid-empty-lines").click(function(){logbird.settings.avoidEmptyLines=$(this).is(":checked")});$(menu.timeUpdate).click(function(){processTimeDiff()})}function routeF5(){$(document).bind("keydown",function(a){if((a.which||a.keyCode)==116){a.preventDefault();logbird.reset()}})}function onScrollEvents(){$(window).scroll(function(){if($(window).scrollTop()>250){$(html.backToTop).fadeIn(200);if(!onMainScreen){$(html.loadTime).fadeOut(200)}}else{$(html.backToTop).fadeOut(200);if(!onMainScreen){$(html.loadTime).fadeIn(200)}}})}function loadParameters(){}(function(a){a.initialize=function(){dialog.init();blacklist.init();setListeners();prepareContext();loadParameters();onScrollEvents();updateTooltips()}})(jQuery);$(document).ready($.initialize);